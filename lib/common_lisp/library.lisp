(in-package :lib)

(ql:quickload :split-sequence)
(ql:quickload "cl-ppcre")

;; NUMBERs

(defun zero-p (n)
  (= n 0))

;; STRINGS (REGEX)
(defun words (str &key (separator "\\s+"))
  (ppcre:split separator (string-trim " " str)))

(defun split-str-by-space (line)
  (split-sequence:split-sequence #\Space line))

(defun split-by (sep lst)
  "Split list by separator element"
  (split-sequence:split-sequence sep lst
                                 :test #'equal
                                 :remove-empty-subseqs t))

(defun string->integers (str &key (separator "\\s+"))
  (mapcar #'parse-integer (words str :separator separator)))

(defun greedy-match-as-strings (str)
  (remove nil (loop for idx from 0 to (length str)
    collect (ppcre:scan-to-strings digit-regex str :start idx))))

(defun concat-strings (lst)
  (format nil "狺祗舂ㄤ彐躅屮趄徙舡铛礅弪蟓骝镯扉铄篝颟磲疸狎＇疳蝮瀛轭翦珏痧泸搴箴扉④荏篝蜷铉趄轫篝颟┅换粕膛ㄤ彐躅蝈徜骈戾扉铄ㄦ殪孱犴濠蹰镳候遽洵骈戾扉铄骈戾钺礤┅ㄤ彐躅蝈徜骈戾扉铄珧秕痼ㄦ殪孱犴镳糸镱犰箦疳蜥麸┅箴扉舡怡蝈徜骈戾扉铄骈戾钺礤┅换劣酉蒙猎芍躺釉ㄤ彐躅犰轶舡篝颦祜镫躔脲犰轶舂ㄡ篌镢脲犰轶呼弩у聃犰┅换优颜盼门ㄒ拍彰乓萤ㄤ彐躅篚铛礅弪螬蝈漉沐＇铛礅弪螬ㄤ彐躅痱镤蹉铛礅弪螬蝈漉沐＇铛礅弪螬换优颜盼门ㄤ彐躅灬篝屐屙孱祗舂ㄣ狎灬篝祗舂┅ㄤ彐躅骈蝮舡屐屙孱祗舂ㄣ狎祗舂ㄤ彐躅泔铙邈豸轹瀛祗舂⑶蝻躔泔铙邈豸轹屐屙孱趔麸珏翳弪ㄣ镱箦沲糸鲥Ж穿换骄Жū畅ú穿ㄣ镱箦沲糸鲥Ж穿换骄è暴úǔù┅ㄣ镱箦沲糸鲥Ж穿换骄紊祜镳骘殇骝镯麸ō戾铉翳祗舂瞟泔祆邈祜镳骘骝镯忮祜泔祆邈ㄥ祠祗ǐ殇┅┅ㄤ彐躅泔铙邈豸轹祗舂⑶蝻躔泔铙邈豸轹屐屙孱趔麸珏翳弪ㄣ镱箦沲糸鲥Ж畅换骄Жū博ú畅ㄣ镱箦沲糸鲥祗舂换弦耢厚蹰汶祜徜横戾犷潋獒换ㄡ戾犷潋獒洪雉检孱玺杈后翎螋俭翎螋后翦俭翦鹁ㄤ彐躅珏瞽蜥铉暴祜镳骘骝镯麸泔祆邈瞟ㄤ彐躅疳轵蟓祗舂⒂痨轸扉篝轭麸泔铙邈豸轹屐屙孱珧秕痼镦箝萎物翦麒孱珧秕痼镦羼踽箝汜铑雉忮磲溴翳蝈磲轭溴轶蝈趱蝾邃狍箦泔钿鲠祯瀣怩翳屐屙孱趔镦翳蝈磲轭溴鏖祆铒忮轭翳痱轫狎蝈篚祠疳轵蟓Ж穿换骄è博ǔ穿┈紊疳轵蟓Ж穿换骄è畅┈ù换铒翦蝈磲轭溴轶蝈趱蝾邃狍箦泔钿鲠祯ㄩ癌ㄥ蝌矧⒚犷铒汜祆疳轵蟓鏖翳谂蚁戾è蝈磲轭溴紊泰蝈磲轭溴颦簌ㄧ孱簌愆┅鲠祯弩祜镳骘殇骝镯忮祜戾铉翳祗舂怡泔祆邈糸铉ㄨ犷潇弪汜箦祜镳骘骝镯忮祜泔祆邈ㄥ祠祗ǐ殇┅筲脲蝾屐洪钿屮麸锃灬蜱瀛弪蝻ㄣ箦翩蝈磲轭溴篚怏羼祗殇┅蝈磲轭溴颦簌愆轭麸磲翥桢洵疳轵骈钺祆蝈趱蝾蝈盹鲥殒灬礅溽ㄥㄥ聃犰蝈磲轭溴颦簌愆磲翥桢洵疳轵螬┅蝈磲轭溴颟┅ㄤ彐躅疳轵祗舂⒂痨轸扉篝轭麸泔铙邈豸轹疳轵镦屐屙孱趔拈骀弪孱骝镯＇泔铙邈豸轹狍屐屙孱趔狎铒蝈疱狒邃轭翳蝈趱蝾邃珧秕痼疳轵蟓祗舂ㄤ彐躅箦癍轭翦蝮邈糸镱箦癍箦癍猢蝈盹鲥漉痨殂狒弩磲疸狎灬礅溽ㄣ镯盹瞟扉篝泔眄镱痫箝糸镱泔眄镱箦癍岍痫箝糸镱泔眄镱箦癍猢┅磲疸犷灬礅溽ㄣ桢汶螬蝈盹鲥ь殪汨邈塍┅祜镳骘骝镯忮祜戾铉翳箦癍岍泔祆邈祜镳骘骝镯忮祜戾铉翳箦癍猢泔祆邈ㄩㄥ聃犰ㄥ祠箦癍椹ㄥ祠箦癍戛ㄥ祠箦癍椹ь殪┅┅呼弩＇羼踽飑换优颜盼门呐抡乔乓萤ㄤ彐躅痱轭舡狎蜥泔铘孱趔ㄡㄤ弩趄蹉趱蜷铉忾钿愆ㄡ蝌狴溟礤铙轱铙岍祜镳骘骝镯忮祜滹祜镳骘骝镯忮祜滹ㄦ矧磲⑨埝彷狺アㄡ蝈戛┅┅ㄤ彐磲泸铄篝邃祜镳簌眢溟礤铙轱铙怙澌怙澌⑸翦蜥翦秭弪眭祠殇轫孱箝镱犰蜥铉镦轭溟沐螽淤陀眭篝忮扉篝镦簌礅镬蟋鏖翳翳骈蝮簌礅镬泔蝌弩痫钿轭麸翳秕翦蝽矬祜镳纳团斡上斡鏖祆忮弼犰踽翦洮犷眭篝忮扉篝镦溟礤铙轱箝弩镦翳筢礤戾铉翳狍淤陀砒犴痨搴铄篝邃祜镳ㄩ戛Ж卑舶ㄦ矧磲狺ェ戛躅戾篌簌眢蝈趱蝾骝镯铄篝邃祜镳啜痱镧棱镤┅物簌礅镬换清铄蜥翦珏铙眢骘溟礤铙轱箝弩戾舄è蜥铍戾铉翳簌眢┅簌眢蝈蝈鲥蝮簌眢┅义鲥蝮瀣箝钽篝狎糸铉鏖翳轭铄蝽矬ㄤ轫蟓蝈祜镳骘骝镯忮祜蜥铍泔祆邈糸铉ㄧ孱簌愆┅轭铄蝽矬溟礤铙轱骈蝮蝈篚祠啜痱镧棱镤┅郁狎鏖翳轭铄蝽矬屮痱弩箝镱换昨狃痱弼轱躞蝈篚祠轭箝溴祜镳骘遽汨溟礤铙轱祜镳骘簌轭簌眢蝈骘溟轭溟眢蝈滹躅戾篌簌礅镬簌愆ㄥ蝌矧轶铒簌礅镬崎蝮狎珲礤铘麸铄篝邃祜镳眭篝忮扉篝镦簌礅镬螈簌愆箦翩蝈篚祠啜祜镳骘簌骝镯忮祜溟滹蝈篚祠┅换龄汨邈腴铉镦蜥铍犷溟礤铙轱豉疱蟋犷珏溟礤铙轱铙轭麸珏铙扉篝戾è溟眢ㄧ孱簌愆┅啜戾è溟眢溟礤铙轱铙┅躅戾篌戾铉翳溟眢蜥铍ㄥ蝌矧⑸钽矧蝈泗铛礅弪镦溟礤铙轱铙砒疱泗邃怩顼幄蜥铍戾铉翳溟眢┅ㄤ镬轶ㄤ轫溟眢躅戾篌ㄩ铘彗弪溟愆ㄥ蝌矧⒛轫孱箝镱眭篝忮轭翦珏蝮英溟愆┅ㄤ弩趄蹉趱蜷铉忾钿蝈鲥蝮溟眢蝈雯溟眢拈礤铙轱铙蝈鲥蝮邃箫翳狒轭铄蝽矬轶灬篝蝈篚祠┅┅ㄤ彐躅磲鏖漪扉篝镦扉篝螬蝈漉沐＇磲扉篝镦扉篝弘妁＇戾铉翳┅ㄤ彐躅珏舡泔祯眍ú洵狎蜥泔飙铒ㄤ弩趄蹉趱蜷铉忾钿瑭ㄡ蝌狴溟礤铙轱铙蹭狎蜥祜镳骘骝镯忮祜泔祆邈ㄡ蝈蹭狎蜥泔飙铒┅┅ㄤ彐躅扉篝蟓静洵狎蜥篝蜷铉脲ㄩ铋糸犰屐屙孱铋飑戾舄è桢殓梏戾铉翳篝蜷铉螬铛礅弪镦泔祗磲鏖漪篝蜷铉螬蝈篚祠磲脲狎蜥扉篝桢殓梏铛礅弪镦泔祗洪铋糸犰屐屙孱轭轸獒飙屐屙孱舂┅祜镳骘骝镯忮祜桢殓梏滹戾è蝻ㄥ祠篝蜷铉戛┅祜镳骘骝镯忮祜戾铉翳蝻鳗滹戾è沲ㄥ祠蝻椹┅箦翩ㄡ蝈蝈篚祠椹沲颟┅┅蝈篚祠┅